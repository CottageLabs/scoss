window.$||(window.$=jQuery);
!function(n){n.fn.bindWithDelay=function(i,t,u,e,o){function l(){var i=n.extend(!0,{},arguments[0]),t=function(){r=null,u.apply(a,[i])};o||clearTimeout(r),o&&r||(r=setTimeout(t,e))}var r=null,a=this;return n.isFunction(t)&&(o=e,e=u,u=t,t=void 0),this.bind(i,t,l)}}(jQuery);
var edges={newEdge:function(e){return e||(e={}),new edges.Edge(e)},Edge:function(e){this.selector=e.selector||"body",this.search_url=edges.getParam(e.search_url,!1),this.datatype=e.datatype||"jsonp",this.preflightQueries=edges.getParam(e.preflightQueries,!1),this.baseQuery=e.baseQuery||!1,this.openingQuery=e.openingQuery||"undefined"!=typeof es?es.newQuery():!1,this.secondaryQueries=edges.getParam(e.secondaryQueries,!1),this.initialSearch=edges.getParam(e.initialSearch,!0),this.staticFiles=edges.getParam(e.staticFiles,[]),this.manageUrl=e.manageUrl||!1,this.urlQuerySource=e.urlQuerySource||"source",this.template=e.template||!1,this.components=e.components||[],this.renderPacks=e.renderPacks||[edges.bs3,edges.nvd3,edges.highcharts,edges.google,edges.d3],this.urlQuery=!1,this.urlParams={},this.shortUrl=!1,this.currentQuery=!1,this.result=!1,this.preflightResults={},this.realisedSecondaryQueries={},this.secondaryResults={},this.searching=!1,this.context=!1,this["static"]={},this.resources={},this.errorLoadingStatic=[],this.startup=function(){if(this.context=$(this.selector),this.context.trigger("edges:pre-init"),this.manageUrl){var e=this.getUrlParams();this.urlQuerySource in e&&(this.urlQuery=es.newQuery({raw:e[this.urlQuerySource]}),delete e[this.urlQuerySource]),this.urlParams=e}this.template&&this.template.draw(this);for(var t=0;t<this.components.length;t++){var r=this.components[t];r.init(this)}this.draw();var s=edges.objClosure(this,"startupPart2");this.loadStaticsAsync(s)},this.startupPart2=function(){var e=edges.objClosure(this,"startupPart3");this.runPreflightQueries(e)},this.startupPart3=function(){var e=this.openingQuery;this.urlQuery&&(e=this.urlQuery,this.urlQuery=!1);for(var t=0;t<this.components.length;t++){var r=this.components[t];r.contrib(e)}this.pushQuery(e),this.context.trigger("edges:post-init"),this.cycle()},this.doQuery=function(){this.cycle()},this.cycle=function(){if(!this.searching)if(this.searching=!0,this.shortUrl=!1,this.context.trigger("edges:pre-query"),this.manageUrl&&this.updateUrl(),this.search_url){var e=edges.objClosure(this,"cyclePart2");this.doPrimaryQuery(e)}else this.cyclePart2()},this.cyclePart2=function(){var e=edges.objClosure(this,"cyclePart3");this.runSecondaryQueries(e)},this.cyclePart3=function(){this.synchronise(),this.context.trigger("edges:pre-render"),this.draw(),this.context.trigger("edges:post-render"),this.searching=!1},this.synchronise=function(){for(var e=0;e<this.components.length;e++){var t=this.components[e];t.synchronise()}},this.draw=function(){for(var e=0;e<this.components.length;e++){var t=this.components[e];t.draw(this)}},this.reset=function(){this.context.trigger("edges:pre-reset");for(var e=this.cloneOpeningQuery(),t=0;t<this.components.length;t++){var r=this.components[t];r.contrib(e)}this.pushQuery(e),this.context.trigger("edges:post-reset"),this.cycle()},this.cloneQuery=function(){return this.currentQuery?$.extend(!0,{},this.currentQuery):!1},this.pushQuery=function(e){this.baseQuery&&e.merge(this.baseQuery),this.currentQuery=e},this.cloneBaseQuery=function(){return this.baseQuery?$.extend(!0,{},this.baseQuery):es.newQuery()},this.cloneOpeningQuery=function(){return this.openingQuery?$.extend(!0,{},this.openingQuery):es.newQuery()},this.doPrimaryQuery=function(e){var t={callback:e};es.doQuery({search_url:this.search_url,queryobj:this.currentQuery.objectify(),datatype:this.datatype,success:edges.objClosure(this,"querySuccess",["result"],t),error:edges.objClosure(this,"queryFail",t)})},this.queryFail=function(e){var t=e.context;this.context.trigger("edges:query-fail"),t()},this.querySuccess=function(e){this.result=e.result;var t=e.callback;this.context.trigger("edges:query-success"),t()},this.runPreflightQueries=function(e){if(!this.preflightQueries||0==Object.keys(this.preflightQueries).length)return void e();this.context.trigger("edges:pre-preflight");for(var t=[],r=Object.keys(this.preflightQueries),s=0;s<r.length;s++){var i=r[s];t.push({id:i,query:this.preflightQueries[i]})}var n=this,c=edges.newAsyncGroup({list:t,action:function(e){var t=e.entry,r=e.success_callback,s=e.error_callback;es.doQuery({search_url:n.search_url,queryobj:t.query.objectify(),datatype:n.datatype,success:r,error:s})},successCallbackArgs:["result"],success:function(e){var t=e.result,r=e.entry;n.preflightResults[r.id]=t},errorCallbackArgs:["result"],error:function(e){n.context.trigger("edges:error-preflight")},carryOn:function(){n.context.trigger("edges:post-preflight"),e()}});c.process()},this.runSecondaryQueries=function(e){if(this.realisedSecondaryQueries={},!this.secondaryQueries||0==Object.keys(this.secondaryQueries).length)return void e();var t=[];for(var r in this.secondaryQueries){var s={};s.query=this.secondaryQueries[r](this),s.id=r,t.push(s),this.realisedSecondaryQueries[r]=s.query}var i=this,n=edges.newAsyncGroup({list:t,action:function(e){var t=e.entry,r=e.success_callback;e.error_callback;es.doQuery({search_url:i.search_url,queryobj:t.query.objectify(),datatype:i.datatype,success:r,complete:!1})},successCallbackArgs:["result"],success:function(e){var t=e.result,r=e.entry;i.secondaryResults[r.id]=t},errorCallbackArgs:["result"],error:function(e){},carryOn:function(){e()}});n.process()},this.getComponent=function(e){for(var t=e.id,r=0;r<this.components.length;r++){var s=this.components[r];if(s.id===t)return s}return!1},this.category=function(e){for(var t=[],r=0;r<this.components.length;r++){var s=this.components[r];s.category===e&&t.push(s)}return t},this.getRenderPackObject=function(e,t){for(var r=0;r<this.renderPacks.length;r++){var s=this.renderPacks[r];if(s&&s.hasOwnProperty(e))return s[e](t)}},this.jq=function(e){return $(e,this.context)},this.getUrlParams=function(){var e={},t=window.location.href,r=!1;t.indexOf("#")>-1&&(r=t.slice(t.indexOf("#")),t=t.substring(0,t.indexOf("#")));for(var s=t.slice(t.indexOf("?")+1).split("&"),i=0;i<s.length;i++){var n=s[i].split("=");if(2===n.length){var c=decodeURIComponent(n[1]);("["==c[0]||"{"==c[0])&&(c=c.replace(/^"/,"").replace(/"$/,""),c=JSON.parse(c)),e[n[0]]=c}}return r&&(e["#"]=r),e},this.urlQueryArg=function(e){e||(e={include_query_string:!0,include_filters:!0,include_paging:!0,include_sort:!0,include_fields:!1,include_aggregations:!1,include_facets:!1});var t=JSON.stringify(this.currentQuery.objectify(e)),r={};return r[this.urlQuerySource]=encodeURIComponent(t),r},this.fullQueryArgs=function(){var e=$.extend(!0,{},this.urlParams);return $.extend(e,this.urlQueryArg()),e},this.fullUrlQueryString=function(){return this._makeUrlQuery(this.fullQueryArgs())},this._makeUrlQuery=function(e){for(var t=Object.keys(e),r=[],s=0;s<t.length;s++){var i=t[s],n=e[i];r.push(i+"="+n)}return r.join("&")},this.fullUrl=function(){var e=this.fullQueryArgs(),t="";e["#"]&&(t="#"+e["#"],delete e["#"]);var r=window.location.toString(),s=r.split("?"),i=s[0]+"?"+this._makeUrlQuery(e)+t;return i},this.updateUrl=function(){if("pushState"in window.history){var e="?"+this.fullUrlQueryString();window.history.pushState("","",e)}},this.loadStaticsAsync=function(e){if(!this.staticFiles||0==this.staticFiles.length)return this.context.trigger("edges:post-load-static"),void e();var t=this,r=edges.newAsyncGroup({list:this.staticFiles,action:function(e){var t=e.entry,r=e.success_callback,s=e.error_callback,i=(t.id,t.url),n=edges.getParam(t.datatype,"text");$.ajax({type:"get",url:i,dataType:n,success:r,error:s})},successCallbackArgs:["data"],success:function(e){var r=e.data,s=e.entry;if(s.processor){var i=s.processor({data:r});t.resources[s.id]=i,s.opening&&s.opening({resource:i,edge:t})}t["static"][s.id]=r},errorCallbackArgs:["data"],error:function(e){t.errorLoadingStatic.push(e.entry.id),t.context.trigger("edges:error-load-static")},carryOn:function(){t.context.trigger("edges:post-load-static"),e()}});r.process()},this.startup()},newAsyncGroup:function(e){return e||(e={}),new edges.AsyncGroup(e)},AsyncGroup:function(e){this.list=e.list,this.successCallbackArgs=e.successCallbackArgs,this.errorCallbackArgs=e.errorCallbackArgs;var t=e.action,r=e.success,s=e.carryOn,i=e.error;this.functions={action:t,success:r,carryOn:s,error:i},this.checkList=[],this.finished=!1,this.construct=function(e){for(var t=0;t<this.list.length;t++)this.checkList.push(0)},this.process=function(e){0==this.list.length&&this.functions.carryOn();for(var t=0;t<this.list.length;t++){var r={index:t},s=edges.objClosure(this,"_actionSuccess",this.successCallbackArgs,r),i=edges.objClosure(this,"_actionError",this.successCallbackArgs,r),n=!1;this.functions.action({entry:this.list[t],success_callback:s,error_callback:i,complete_callback:n})}},this._actionSuccess=function(e){var t=e.index;delete e.index,e.entry=this.list[t],this.functions.success(e),this.checkList[t]=1,this._isComplete()&&this._finalise()},this._actionError=function(e){var t=e.index;delete e.index,e.entry=this.list[t],this.functions.error(e),this.checkList[t]=-1,this._isComplete()&&this._finalise()},this._actionComplete=function(e){},this._isComplete=function(){return-1===$.inArray(0,this.checkList)},this._finalise=function(){this.finished||(this.finished=!0,this.functions.carryOn())},this.construct()},newRenderer:function(e){return e||(e={}),new edges.Renderer(e)},Renderer:function(e){this.component=e.component||!1,this.init=function(e){this.component=e},this.draw=function(e){}},newComponent:function(e){return e||(e={}),new edges.Component(e)},Component:function(e){this.id=e.id,this.renderer=e.renderer,this.category=e.category||"none",this.defaultRenderer=e.defaultRenderer||"newRenderer",this.init=function(e){this.edge=e,this.context=this.edge.jq("#"+this.id),this.renderer||(this.renderer=this.edge.getRenderPackObject(this.defaultRenderer)),this.renderer&&this.renderer.init(this)},this.draw=function(){this.renderer&&this.renderer.draw()},this.contrib=function(e){},this.synchronise=function(){},this.jq=function(e){return this.edge.jq(e)}},newSelector:function(e){return e||(e={}),edges.Selector.prototype=edges.newComponent(e),new edges.Selector(e)},Selector:function(e){this.field=e.field,this.display=e.display||this.field,this.active=e.active||!0,this.disabled=e.disabled||!1,this.category=e.category||"selector"},newTemplate:function(e){return e||(e={}),new edges.Template(e)},Template:function(e){this.draw=function(e){}},instantiate:function(e,t,r){t||(t={}),r&&(e.prototype=r(t));var s=new e(t);return r&&(s.__proto_constructor__=r),s},up:function(e,t,r){var s=new e.__proto_constructor__;s[t].apply(e,r)},objClosure:function(e,t,r,s){return function(){if(r){for(var i={},n=0;n<r.length;n++)arguments.length>n&&(i[r[n]]=arguments[n]);s&&(i=$.extend(i,s)),e[t](i)}else{var c=Array.prototype.slice,o=c.apply(arguments);s&&o.push(s),e[t].apply(e,o)}}},eventClosure:function(e,t,r){return function(s){(!r||r(s))&&(s.preventDefault(),e[t](this))}},css_classes:function(e,t,r){var s=e+"-"+t;return r&&(s+=" "+s+"-"+r.component.id),s},css_class_selector:function(e,t,r){var s="."+e+"-"+t;return r&&(s+=s+"-"+r.component.id),s},css_id:function(e,t,r){var s=e+"-"+t;return r&&(s+="-"+r.component.id),s},css_id_selector:function(e,t,r){return"#"+edges.css_id(e,t,r)},on:function(e,t,r,s,i,n){r.component&&r.component.id?t=t+"."+r.component.id:r.namespace&&(t=t+"."+r.namespace);var c=edges.eventClosure(r,s,n);i?r.component?r.component.jq(e).bindWithDelay(t,c,i):r.edge?r.edge.jq(e).bindWithDelay(t,c,i):console.log("attempt to bindWithDelay on caller which has neither inner component or edge"):r.component?r.component.jq(e).on(t,c):r.edge?r.edge.jq(e).on(t,c):console.log("attempt to bindWithDelay on caller which has neither inner component or edge")},escapeHtml:function(e,t){if(void 0===t&&(t=""),void 0===e||null==e)return t;try{return"function"!=typeof e.replace?e:e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}catch(r){return t}},objVal:function(e,t,r){void 0===r&&(r=!1);for(var s=e.split("."),i=t,n=0;n<s.length;n++){var c=s[n];if(!(c in i))return r;i=i[c]}return i},getParam:function(e,t){return void 0!==e?e:t},safeId:function(e){return e.replace(/&/g,"_").replace(/</g,"_").replace(/>/g,"_").replace(/"/g,"_").replace(/'/g,"_").replace(/\./gi,"_").replace(/\:/gi,"_").replace(/\s/gi,"_")},numFormat:function(e){var t=edges.getParam(e.prefix,""),r=edges.getParam(e.zeroPadding,!1),s=edges.getParam(e.decimalPlaces,!1),i=edges.getParam(e.thousandsSeparator,!1),n=edges.getParam(e.decimalSeparator,"."),c=edges.getParam(e.suffix,"");return function(e){e=parseFloat(e),e=s!==!1?e.toFixed(s):e.toString();var o=e.split(".");if(r!==!1){for(var a=r-o[0].length,u="",h=0;a>h;h++)u+="0";o[0]=u+o[0]}return i!==!1&&(o[0]=o[0].replace(/\B(?=(\d{3})+(?!\d))/g,i)),1==o.length?t+o[0]+c:t+o[0]+n+o[1]+c}},numParse:function(e){var t=new RegExp(",","g");return function(e){return e=e.trim(),e=e.replace(t,""),parseFloat(e)}}};
$.extend(edges,{csv:{serialise:function(e){var t=e.data;return Papa.unparse(t,{newline:"\n"})},newObjectByRow:function(e){return e||(e={}),new edges.csv.ObjectByRow(e)},ObjectByRow:function(e){this.sheet=!1,this.filters=[],this.parse=function(e){var t=e.data.replace(/\r\n/g,"\n");this.sheet=Papa.parse(t,{header:!0,newline:"\n",skipEmptyLines:!0})},this.add_filter=function(e){var t=e.filter;this.filters.push(t)},this.clear_filter=function(e){for(var t=e.filter,r=!1,n=0;n<this.filters.length;n++){var i=this.filters[n],s=t.field===i.field,a=t.type===i.type||void 0===t.type,g=void 0===t.value||t.value.toString()===i.value.toString();if(s&&a&&g){r=n;break}}r!==!1&&this.filters.splice(r,1)},this.iterator=function(e){e||(e={});var t=edges.getParam(e.filtered,!0),r=0,n=this;return{next:function(){if(n.sheet.data.length<=r)return!1;for(var e=r;e<n.sheet.data.length;e++){var i=n.sheet.data[e],s=!1;if(s=t?n._filterMatch({record:i}):!0)return r=e+1,i}return!1}}},this.aggregation=function(e){var t=e.agg,r=Object.keys(t)[0],n=t[r],i=edges.getParam(e.filtered,!0);return"terms"===r?this._termsAggregation({field:n,filtered:i}):[]},this.applyAggregations=function(e){function t(e,r){e.finalise({context:r});for(var n=0;n<e.nested.length;n++){var i=e.nested[n];if("buckets"in r)for(var s=0;s<r.buckets.length;s++){var a=r.buckets[s];if("aggs"in a){r.buckets[s].aggs[i.name];t(i,r)}}}}for(var r=e.aggs,n=edges.getParam(e.filtered,!0),i={},s=0;s<r.length;s++)i[r[s].name]={name:r[s].name};for(var a=this.iterator({filtered:n}),g=a.next();g;){for(var s=0;s<r.length;s++){var o=i[r[s].name];r[s].consume({doc:g,context:o})}g=a.next()}for(var s=0;s<r.length;s++){var o=i[r[s].name];t(r[s],o)}return i},this._termsAggregation=function(e){for(var t=e.field,r=edges.getParam(e.filtered,!0),n=[],i={},s=this.iterator({filtered:r}),a=s.next();a;){if(a.hasOwnProperty(t)){var g=a[t];if(g in i)n[i[g]].count++;else{var o=n.length;n.push({term:g,count:1}),i[g]=o}}a=s.next()}return n},this._filterMatch=function(e){for(var t=e.record,r=0;r<this.filters.length;r++){var n=this.filters[r];if("exact"!==n.type)return!1;if(!this._exactFilterMatch({filter:n,record:t}))return!1}return!0},this._exactFilterMatch=function(e){var t=e.filter,r=e.record,n=t.field,i=t.value;return r[n]!==i?!1:!0},this.parse(e)},newAggregation:function(e){return edges.instantiate(edges.csv.Aggregation,e)},Aggregation:function(e){this.name=e.name,this.nested=edges.getParam(e.nested,[]),this.consume=function(e){var t=this.aggregate(e);if(t!==!1&&this.nested.length>0){if(!("aggs"in t)){t.aggs={};for(var r=0;r<this.nested.length;r++)t.aggs[this.nested[r].name]={name:this.nested[r].name}}for(var r=0;r<this.nested.length;r++){var n=t.aggs[this.nested[r].name];this.nested[r].consume({doc:e.doc,context:n})}}},this.aggregate=function(e){},this.finalise=function(e){}},newTermsAggregation:function(e){return edges.instantiate(edges.csv.TermsAggregation,e,edges.csv.newAggregation)},TermsAggregation:function(e){this.field=e.field,this.order=edges.getParam(e.order,!1),this.orderDir=edges.getParam(e.orderDir,"asc"),this.aggregate=function(e){var t=e.doc,r=e.context;if("posMap"in r||(r.posMap={}),"buckets"in r||(r.buckets=[]),t.hasOwnProperty(this.field)){var n=t[this.field];if(n in r.posMap)r.buckets[r.posMap[n]].count++;else{var i=r.buckets.length;r.buckets.push({term:n,count:1}),r.posMap[n]=i}return r.buckets[r.posMap[n]]}return!1},this.finalise=function(e){var t=e.context;"posMap"in t&&delete t.posMap,"buckets"in t?t.buckets.sort(this._getSortFunction()):t.buckets=[]},this._getSortFunction=function(e){return"term"===this.order?function(e,t){return e===t?0:e.term<t.term?"asc"===this.orderDir?1:-1:"asc"===this.orderDir?-1:1}:void 0}},newSumAggregation:function(e){return edges.instantiate(edges.csv.SumAggregation,e,edges.csv.newAggregation)},SumAggregation:function(e){this.field=e.field,this.numParse=edges.numParse(),this.aggregate=function(e){var t=e.doc,r=e.context;if("sum"in r||(r.sum=0),t.hasOwnProperty(this.field)){var n=t[this.field];r.sum+=this.numParse(n)}return!1},this.finalise=function(e){var t=e.context;"sum"in t||(t.sum=0)}}}});
$.extend(edges,{newChart:function(e){return e||(e={}),edges.Chart.prototype=edges.newComponent(e),new edges.Chart(e)},Chart:function(e){this.category=e.category||"chart",this.display=e.display||"",this.dataSeries=e.dataSeries||!1,this.dataFunction=e.dataFunction||!1,this.dataFunctionClosure=e.dataFunctionClosure||!1,this.aggregations=e.aggregations||[],this.dfArgs=e.dfArgs||{useAggregations:[],seriesKeys:{}},this.defaultRenderer=e.defaultRenderer||"newMultibarRenderer",this.init=function(e){edges.newComponent().init.call(this,e);for(var t=0;t<this.aggregations.length;t++){var r=this.aggregations[t];-1===$.inArray(r.name,this.dfArgs.useAggregations)&&this.dfArgs.useAggregations.push(r.name)}this.aggregations.length>0&&this.dataFunctionClosure&&(this.dataFunction=this.dataFunctionClosure(this.dfArgs))},this.contrib=function(e){for(var t=0;t<this.aggregations.length;t++)e.addAggregation(this.aggregations[t])},this.synchronise=function(){this.dataFunction&&(this.dataSeries=this.dataFunction(this))}},ChartDataFunctions:{terms:function(e){var t=e.useAggregations||[],r=e.seriesKeys||{};return function(e){var a=[];if(!e.edge.result)return a;for(var n=0;n<t.length;n++){var s=t[n],i=e.edge.result.data.aggregations[s].buckets,u={};u.key=r[s],u.values=[];for(var l=0;l<i.length;l++){var o=i[l].doc_count,d=i[l].key;u.values.push({label:d,value:o})}a.push(u)}return a}},termsStats:function(e){var t=e.useAggregations||[],r=e.seriesKeys||{},a=e.seriesFor||[];return function(e){var n=[];if(!e.edge.result)return n;for(var s=0;s<t.length;s++)for(var i=t[s],u=i.split(" "),l=0;l<a.length;l++){var o=a[l],d={};d.key=r[i+" "+o],d.values=[];for(var g=e.edge.result.data.aggregations[u[0]].buckets,h=0;h<g.length;h++){var f=g[h][u[1]],v=g[h].key,c=f[o];d.values.push({label:v,value:c})}n.push(d)}return n}},recordsXY:function(e){var t=e.x,r=void 0===e.x_default?0:e.x_default,a=e.y,n=void 0===e.y_default?0:e.y_default,s=e.key;return function(e){var i=[];if(!e.edge.result)return i;var u={};u.key=s,u.values=[];for(var l=e.edge.result.results(),o=0;o<l.length;o++){var d=l[o],g=edges.objVal(t,d,r),h=edges.objVal(a,d,n);u.values.push({label:g,value:h})}return i.push(u),i}},cumulativeXY:function(e){var t=e.x,r=void 0===e.x_default?0:e.x_default,a=e.y,n=void 0===e.y_default?0:e.y_default,s=e.key,i=e.accumulate||"y";return function(e){var u=[];if(!e.edge.result)return u;var l={};l.key=s,l.values=[];for(var o=0,d=e.edge.result.results(),g=0;g<d.length;g++){var h=d[g],f=edges.objVal(t,h,r),v=edges.objVal(a,h,n);"x"===i?(o+=f,l.values.push({label:o,value:v})):"y"===i&&(o+=v,l.values.push({label:f,value:o}))}return u.push(l),u}},totalledList:function(e){var t=e.listPath||"",r=e.seriesKey||"",a=e.keyField||!1,n=e.valueField||!1;return function(e){var s=[];if(!e.edge.result)return s;var i={};i.key=r,i.values=[];for(var u={},l=e.edge.result.results(),o=0;o<l.length;o++)for(var d=l[o],g=edges.objVal(t,d,[]),h=0;h<g.length;h++){var f=g[h],v=edges.objVal(a,f,!1),c=edges.objVal(n,f,0);v in u?u[v]+=c:u[v]=c}for(v in u){var p=u[v];i.values.push({label:v,value:p})}return s.push(i),s}}},newPieChart:function(e){return e||(e={}),edges.PieChart.prototype=edges.newChart(e),new edges.PieChart(e)},PieChart:function(e){this.defaultRenderer=e.defaultRenderer||"newPieChartRenderer"},newHorizontalMultibar:function(e){return e||(e={}),edges.HorizontalMultibar.prototype=edges.newChart(e),new edges.HorizontalMultibar(e)},HorizontalMultibar:function(e){this.defaultRenderer=e.defaultRenderer||"newHorizontalMultibarRenderer"},newMultibar:function(e){return e||(e={}),edges.Multibar.prototype=edges.newChart(e),new edges.Multibar(e)},Multibar:function(e){this.defaultRenderer=e.defaultRenderer||"newMultibarRenderer"},newSimpleLineChart:function(e){return e||(e={}),edges.SimpleLineChart.prototype=edges.newChart(e),new edges.SimpleLineChart(e)},SimpleLineChart:function(e){this.xAxisLabel=e.xAxisLabel||"",this.yAxisLabel=e.yAxisLabel||"",this.defaultRenderer=e.defaultRenderer||"newSimpleLineChartRenderer"},newChartsTable:function(e){return e||(e={}),edges.ChartsTable.prototype=edges.newComponent(e),new edges.ChartsTable(e)},ChartsTable:function(e){this.chartComponents=edges.getParam(e.chartComponents,!1),this.tabularise=edges.getParam(e.tabularise,!1),this.defaultRenderer=e.defaultRenderer||"newChartsTableRenderer",this.results=[],this.synchronise=function(){if(this.results=[],this.chartComponents){for(var e=[],t=0;t<this.edge.components.length;t++){var r=this.edge.components[t];$.inArray(r.id,this.chartComponents)>-1&&e.push(r)}this.tabularise&&(this.results=this.tabularise(e))}}}});
$.extend(edges,{loading:{newLoadingBar:function(e){return edges.instantiate(edges.loading.LoadingBar,e,edges.newComponent)},LoadingBar:function(e){this.percent=edges.getParam(e.percent,0),this.x=edges.getParam(e.x,0),this.y=edges.getParam(e.y,0),this.calculate=edges.getParam(e.calculate,!1),this.synchronise=function(){if(this.calculate!==!1){var e=this.calculate(this);this.percent=e.pc,this.x=e.x,this.y=e.y}}}}});
$.extend(edges,{loading_io:{newLoadingIORendererBS3:function(e){return edges.instantiate(edges.loading_io.LoadingIORendererBS3,e,edges.newRenderer)},LoadingIORendererBS3:function(e){this.preset=edges.getParam(e.preset,!1),this.labelCenter=edges.getParam(e.labelCenter,!0),this.title=edges.getParam(e.title,!1),this.showXofY=edges.getParam(e.showXofY,!1),this.xOfYForm=edges.getParam(e.xOfYForm,"{x} of {y}"),this.xyNumFormat=edges.getParam(e.xyNumFormat,!1),this.stroke=edges.getParam(e.stroke,!1),this.strokeWidth=edges.getParam(e.strokeWidth,!1),this.strokeTrail=edges.getParam(e.strokeTrail,!1),this.strokeTrailWidth=edges.getParam(e.strokeTrailWidth,!1),this.fill=edges.getParam(e.fill,!1),this.namespace="edges-loading_io-renderer",this.barRef=!1,this.draw=function(){var e=edges.css_id(this.namespace,"bar",this),t=edges.css_classes(this.namespace,"bar",this),s=edges.css_classes(this.namespace,"container",this),i="";this.preset!==!1&&(i=" data-preset="+this.preset+" ");var a="";this.stroke!==!1&&(a=" data-stroke="+this.stroke+" ");var r="";this.strokeWidth!==!1&&(r=" data-stroke-width="+this.strokeWidth+" ");var h="";this.strokeTrail!==!1&&(h=" data-stroke-trail="+this.strokeTrail+" ");var o="";this.strokeTrailWidth!==!1&&(o=" data-stroke-trail-width="+this.strokeTrailWidth+" ");var d="";this.labelCenter===!0&&(d="label-center");var n="";if(this.title!==!1){var l=edges.css_classes(this.namespace,"title",this);n='<div class="'+l+'">'+this.title+"</div>"}var g='<div id="'+e+'"                     class="'+t+" "+d+'"                     data-value="'+this.component.percent+'"                     '+i+a+r+h+o+"></div>",m="";if(this.showXofY===!0){var c=this.component.x,p=this.component.y;this.xyNumFormat!==!1&&(c=this.xyNumFormat(this.component.x),p=this.xyNumFormat(this.component.y));var v=this.xOfYForm;v=v.replace("{x}",c).replace("{y}",p);var f=edges.css_classes(this.namespace,"xofy",this);m='<div class="'+f+'">'+v+"</div>"}var k='<div class="'+s+'">'+n+g+m+"</div>";this.component.context.html(k);var x=edges.css_id_selector(this.namespace,"bar",this);this.barRef=new ldBar(x),this.fill&&this.component.jq(x).find("path.baseline").attr("fill",this.fill)}}}});
$.extend(edges,{nvd3:{DataSeriesConversions:{toXY:function(e){for(var t=[],a=0;a<e.length;a++){var i=e[a],s={};s.key=i.key,s.values=[];for(var r=0;r<i.values.length;r++){var n=i.values[r];s.values.push({x:n.label,y:n.value})}t.push(s)}return t}},tools:{persistingPieColour:function(e,t){e||(e=["#ea6ccb","#8fc8b0","#a9cf85","#d90d4c","#6c537e","#64d54f","#ecc7c4","#f1712b"]),t||(t={});var a=0;return function(i,s){if(i.label in t)return t[i.label];var r=e[a%(e.length-1)];return a++,t[i.label]=r,r}}},newPieChartRenderer:function(e){return e||(e={}),edges.nvd3.PieChartRenderer.prototype=edges.newRenderer(e),new edges.nvd3.PieChartRenderer(e)},PieChartRenderer:function(e){this.showLabels=edges.getParam(e.showLabels,!0),this.donut=edges.getParam(e.donut,!1),this.labelThreshold=e.labelThreshold||.05,this.transitionDuration=e.transitionDuration||500,this.noDataMessage=e.noDataMessage||!1,this.color=e.color||!1,this.legendPosition=e.legendPosition||"top",this.labelsOutside=edges.getParam(e.labelsOutside,!1),this.valueFormat=e.valueFormat||!1,this.marginTop=e.marginTop||30,this.marginRight=e.marginRight||30,this.marginBottom=e.marginBottom||30,this.marginLeft=e.marginLeft||30,this.namespace="edges-nvd3-pie",this.draw=function(){var e=edges.css_classes(this.namespace,"display",this),t="";this.component.display&&(t='<span class="'+e+'">'+this.component.display+"</span><br>");var a=edges.css_id(this.namespace,"svg",this),i=edges.css_id_selector(this.namespace,"svg",this);this.component.context.html(t+'<svg id="'+a+'"></svg>');var s=this.component.dataSeries;s||(s=[]),s=s.length>0?s[0].values:[];var r=this;nv.addGraph(function(){var e=nv.models.pieChart().x(function(e){return e.label}).y(function(e){return e.value}).showLabels(r.showLabels).legendPosition(r.legendPosition).labelsOutside(r.labelsOutside).margin({left:r.marginLeft,right:r.marginRight,top:r.marginTop,bottom:r.marginBottom});return r.noDataMessage&&e.noData(r.noDataMessage),r.color&&e.color(r.color),r.valueFormat&&e.valueFormat(r.valueFormat),d3.select(i).datum(s).transition().duration(r.transitionDuration).call(e),e})}},newHorizontalMultibarRenderer:function(e){return e||(e={}),edges.nvd3.HorizontalMultibarRenderer.prototype=edges.newRenderer(e),new edges.nvd3.HorizontalMultibarRenderer(e)},HorizontalMultibarRenderer:function(e){this.showValues=edges.getParam(e.showValues,!0),this.toolTips=edges.getParam(e.toolTips,!0),this.controls=edges.getParam(e.controls,!1),this.stacked=edges.getParam(e.stacked,!1),this.legend=edges.getParam(e.legend,!0),this.color=e.color||!1,this.noDataMessage=edges.getParam(e.noDataMessage,!1),this.transitionDuration=e.transitionDuration||500,this.marginTop=e.marginTop||30,this.marginRight=e.marginRight||50,this.marginBottom=e.marginBottom||50,this.marginLeft=e.marginLeft||200,this.yTickFormat=edges.getParam(e.yTickFormat,",.0f"),this.xTickFormat=edges.getParam(e.xTickFormat,!1),this.valueFormat=edges.getParam(e.valueFormat,!1),this.xAxisLabel=edges.getParam(e.xAxisLabel,!1),this.yAxisLabel=edges.getParam(e.yAxisLabel,!1),this.tooltipGenerator=edges.getParam(e.tooltipGenerator,!1),this.dynamicHeight=edges.getParam(e.dynamicHeight,!1),this.barHeight=edges.getParam(e.barHeight,0),this.reserveAbove=edges.getParam(e.reserveAbove,0),this.reserveBelow=edges.getParam(e.reserveBelow,0),this.groupSpacing=edges.getParam(e.groupSpacing,!1),this.namespace="edges-nvd3-horizontal-multibar",this.draw=function(){$(".nvtooltip").remove();var e=this.component.dataSeries;e||(e=[]);var t="";if(this.dynamicHeight){for(var a=0,i=0;i<e.length;i++){var s=e[i];s.values.length>a&&(a=s.values.length)}var r=this.reserveAbove+this.reserveBelow+a*this.barHeight;t='style="height:'+r+'px"'}var n=edges.css_id(this.namespace,"svg",this),o=edges.css_id_selector(this.namespace,"svg",this);this.component.context.html("<div "+t+'><svg id="'+n+'"></svg></div>');var l=this;nv.addGraph(function(){var t=nv.models.multiBarHorizontalChart().x(function(e){return e.label}).y(function(e){return e.value}).margin({top:l.marginTop,right:l.marginRight,bottom:l.marginBottom,left:l.marginLeft}).showValues(l.showValues).tooltips(l.toolTips).showControls(l.controls).showLegend(l.legend);if(l.stacked&&t.multibar.stacked(l.stacked),l.yTickFormat){var a=l.yTickFormat;"string"==typeof l.yTickFormat&&(a=d3.format(l.yTickFormat)),t.yAxis.tickFormat(a)}if(l.yAxisLabel&&t.yAxis.axisLabel(l.yAxisLabel),l.xTickFormat){var a=l.xTickFormat;"string"==typeof l.xTickFormat&&(a=d3.format(l.xTickFormat)),t.xAxis.tickFormat(a)}if(l.xAxisLabel&&t.xAxis.axisLabel(l.xAxisLabel),l.valueFormat){var a=l.valueFormat;"string"==typeof l.valueFormat&&(a=d3.format(l.xTickFormat)),t.valueFormat(a)}return l.noDataMessage&&t.noData(l.noDataMessage),l.color&&t.color(l.color),l.tooltipGenerator&&t.tooltip.contentGenerator(l.tooltipGenerator),l.groupSpacing&&t.groupSpacing(l.groupSpacing),d3.select(o).datum(e).transition().duration(l.transitionDuration).call(t),nv.utils.windowResize(t.update),t})}},newMultibarRenderer:function(e){return e||(e={}),edges.nvd3.MultibarRenderer.prototype=edges.newRenderer(e),new edges.nvd3.MultibarRenderer(e)},MultibarRenderer:function(e){this.xTickFormat=e.xTickFormat||",.2f",this.yTickFormat=e.yTickFormat||",.2f",this.transitionDuration=e.transitionDuration||500,this.controls=edges.getParam(e.controls,!1),this.barColor=e.barColor||!1,this.showLegend=edges.getParam(e.showLegend,!0),this.xAxisLabel=e.xAxisLabel||"",this.yAxisLabel=e.yAxisLabel||"",this.namespace="edges-nvd3-multibar",this.draw=function(){var e=edges.css_classes(this.namespace,"display",this),t="";this.component.display&&(t='<span class="'+e+'">'+this.component.display+"</span><br>");var a=edges.css_id(this.namespace,"svg",this),i=edges.css_id_selector(this.namespace,"svg",this);this.component.context.html(t+'<svg id="'+a+'"></svg>');var s=this.component.dataSeries;s||(s=[]),s=edges.nvd3.DataSeriesConversions.toXY(this.component.dataSeries);var r=this;nv.addGraph(function(){var e=nv.models.multiBarChart().showControls(r.controls);return e.xAxis.axisLabel(r.xAxisLabel).tickFormat(d3.format(r.xTickFormat)),e.yAxis.axisLabel(r.yAxisLabel).tickFormat(d3.format(r.yTickFormat)),r.barColor&&e.barColor(r.barColor),e.showLegend(r.showLegend),d3.select(i).datum(s).transition().duration(r.transitionDuration).call(e),nv.utils.windowResize(e.update),e})}},newSimpleLineChartRenderer:function(e){return e||(e={}),edges.nvd3.SimpleLineChartRenderer.prototype=edges.newRenderer(e),new edges.nvd3.SimpleLineChartRenderer(e)},SimpleLineChartRenderer:function(e){this.interactiveGuideline=e.interactiveGuideline||!0,this.xTickFormat=e.xTickFormat||",.2f",this.yTickFormat=e.yTickFormat||",.2f",this.transitionDuration=e.transitionDuration||500,this.lineColor=e.lineColor||!1,this.includeOnY=e.includeOnY||!1,this.showLegend=edges.getParam(e.showLegend,!0),this.xAxisLabel=e.xAxisLabel||"",this.yAxisLabel=e.yAxisLabel||"",this.namespace="edges-nvd3-simple-line-chart",this.draw=function(){var e=edges.css_classes(this.namespace,"display",this),t="";this.component.display&&(t='<span class="'+e+'">'+this.component.display+"</span><br>");var a=edges.css_id(this.namespace,"svg",this),i=edges.css_id_selector(this.namespace,"svg",this);this.component.context.html(t+'<svg id="'+a+'"></svg>');var s=this.component.dataSeries;s||(s=[]);var r=edges.nvd3.DataSeriesConversions.toXY(s),n=this;nv.addGraph(function(){var e=nv.models.lineChart().useInteractiveGuideline(n.interactiveGuideline);return e.xAxis.axisLabel(n.xAxisLabel).tickFormat(d3.format(n.xTickFormat)),n.lineColor&&e.color(n.lineColor),n.includeOnY&&e.forceY(n.includeOnY),e.yAxis.axisLabel(n.yAxisLabel).tickFormat(d3.format(n.yTickFormat)),e.showLegend(n.showLegend),d3.select(i).datum(r).transition().duration(n.transitionDuration).call(e),nv.utils.windowResize(e.update),e})}}}});
$.extend(!0,edges,{bs3:{newTabularResultsRenderer:function(e){return e||(e={}),edges.bs3.TabularResultsRenderer.prototype=edges.newRenderer(e),new edges.bs3.TabularResultsRenderer(e)},TabularResultsRenderer:function(e){this.noResultsText=e.noResultsText||"No results to display",this.defaultCellContent=e.defaultCellContent||"-",this.fieldDisplay=e.fieldDisplay||[],this.displayListedOnly=edges.getParam(e.displayListedOnly,!0),this.headerOrderingFunction=edges.getParam(e.headerOrderingFunction,!1),this.download=edges.getParam(e.download,!1),this.downloadText=edges.getParam(e.downloadText,"download"),this.downloadPrefix=edges.getParam(e.downloadPrefix,"download"),this.namespace="edges-bs3-tabular-results",this.draw=function(){var e=edges.css_classes(this.namespace,"no-results",this),s='<div class="row"><div class="col-md-12"><div class="'+e+'">'+this.noResultsText+"</div></div></div>";this.component.results===!1&&(s="");var t=this.component.results;if(t&&t.length>0){var a=this._getHeaderRow(),i=edges.css_classes(this.namespace,"table",this),d=edges.css_classes(this.namespace,"header",this),l=edges.css_classes(this.namespace,"cell",this),n=edges.css_classes(this.namespace,"download",this),r=edges.css_classes(this.namespace,"tablediv",this),o=edges.css_id(this.namespace,"download",this),h="";this.download&&(h='<div class="row"><div class="col-md-12"><div class="'+n+'"><a href="#" id="'+o+'">'+edges.escapeHtml(this.downloadText)+"</a></div></div></div>");var s='<div class="table-responsive '+r+'">';s+='<table class="'+i+'"><thead><tr>_HEADERS_</tr></thead><tbody>';for(var c=[],g=0;g<a.length;g++){for(var f=!1,p=0;p<this.fieldDisplay.length;p++){var u=this._getFieldDisplay(a[g]);if(u){c.push(u.display),f=!0;break}}f||c.push(a[g])}for(var v="",g=0;g<c.length;g++){var y=c[g],w=edges.css_classes(this.namespace,"header-"+edges.safeId(y),this);v+='<th class="'+d+" "+w+'">'+y+"</th>"}s=s.replace(/_HEADERS_/g,v);for(var g=0;g<t.length;g++){var m=t[g];s+="<tr>";for(var p=0;p<a.length;p++){var b=a[p],_=this.defaultCellContent,u=this._getFieldDisplay(b);u&&(_=u["default"]);var D=edges.objVal(b,m,_);D=u.valueFunction?u.valueFunction(D):edges.escapeHtml(D);var R=edges.css_classes(this.namespace,"cell-"+edges.safeId(b),this);s+='<td class="'+l+" "+R+'">'+D+"</td>"}s+="</tr>"}s+="</tbody></table></div>"+h}if(this.component.context.html(s),this.download){var T=edges.css_id_selector(this.namespace,"download",this);edges.on(T,"click",this,"doDownload")}},this.doDownload=function(e){if(this.download){var s=this._downloadData(),t=new Blob([s.data],{type:s.fileType}),a=window.URL.createObjectURL(t),i=document.createElement("a");document.body.appendChild(i),i.style="display: none",i.href=a,i.download=s.fileName,i.click(),window.URL.revokeObjectURL(a)}},this._downloadData=function(){if(!this.download)return!1;var e=[],s=this.component.results;if(s&&s.length>0){for(var t=this._getHeaderRow(),a=[],i=0;i<t.length;i++){for(var d=!1,l=0;l<this.fieldDisplay.length;l++){var n=this._getFieldDisplay(t[i]);if(n){a.push(n.display),d=!0;break}}d||a.push(t[i])}e.push(a);for(var i=0;i<s.length;i++){for(var r=s[i],o=[],l=0;l<t.length;l++){var h=t[l],c=edges.objVal(h,r,"");o.push(c)}e.push(o)}}var g=edges.csv.serialise({data:e}),f="text/csv;charset=UTF-8",p="csv",u=(new Date).getTime(),v=this.downloadPrefix+"_"+u+"."+p;return{data:g,fileType:f,fileName:v}},this._getFieldDisplay=function(e){for(var s=0;s<this.fieldDisplay.length;s++)if(this.fieldDisplay[s].field==e)return this.fieldDisplay[s];return!1},this._getHeaderRow=function(){if(this.headerOrderingFunction)return this.headerOrderingFunction(this);var e=this.component.results,s=e!==!1&&e.length>0;if(!s||0==this.fieldDisplay.length&&this.displayListedOnly)return[];var t=[];if(this.fieldDisplay.length>0)for(var a=0;a<this.fieldDisplay.length;a++)t.push(this.fieldDisplay[a].field);if(!this.displayListedOnly){for(var i={},a=0;a<e.length;a++)for(var d=Object.keys(e[a]),l=0;l<d.length;l++)d[l]in i||(i[d[l]]=!0);var n=Object.keys(i);n.sort();for(var a=0;a<n.length;a++)-1==$.inArray(n[a],t)&&t.push(n[a])}return t}}}});
var scoss={activeEdges:{},theme:{light_blue:"#46bee0",dark_blue:"#014993",grey:"#49474d",light_green:"#f1f7ee",pie_colours:["#014993","#46bee0","#3B8EA5","#F5EE9E","#F49E4C","#E84855"]},euroFormatter:edges.numFormat({prefix:"&euro;",thousandsSeparator:","}),currencyFormatter:edges.numFormat({prefix:"â‚¬",thousandsSeparator:","}),continentPercentFormatterClosure:function(e){return function(s){var r=scoss.activeEdges[e],t=r.resources.master_aggregations.total_committed.sum,o=100;t>0&&(o=Math.round(s/t*100));var n=scoss.currencyFormatter(s);return n+=" ("+o+"%)"}},preprocessMasterSheet:function(e){var s=e.service_id;return function(e){var r=e.resource,t=e.edge;r.add_filter({filter:{field:"Service ID",value:s,type:"exact"}});var o=[edges.csv.newSumAggregation({name:"total_committed",field:"Funding Committed (EUR)"}),edges.csv.newSumAggregation({name:"total_paid",field:"Total Paid (EUR)"}),edges.csv.newTermsAggregation({name:"country",field:"Funder Country",nested:[edges.csv.newSumAggregation({name:"total_committed",field:"Funding Committed (EUR)"})]}),edges.csv.newTermsAggregation({name:"continent",field:"Funder Continent",nested:[edges.csv.newSumAggregation({name:"total_committed",field:"Funding Committed (EUR)"})]}),edges.csv.newTermsAggregation({name:"funders",field:"Funder Full Name",order:"term",nested:[edges.csv.newSumAggregation({name:"total_committed",field:"Funding Committed (EUR)"})]})];t.resources.master_aggregations=r.applyAggregations({aggs:o})}},preprocessServiceProviderSheet:function(e){var s=e.service_id;return function(e){var r=e.resource,t=e.edge;r.add_filter({filter:{field:"Service ID",value:s,type:"exact"}});var o=r.iterator();t.resources.service_provider=o.next()}},progressCommitted:function(e){var s=e.edge.resources.master_aggregations,r=s.total_committed,t=e.edge.resources.service_provider,o=edges.numParse(),n=r.sum,a=t["Funding Target (EUR)"];a=o(a);var i=0;return 0!==n&&(i=0),i=n/a*100,i>100&&(i=100),{pc:i,x:n,y:a}},progressPaid:function(e){var s=e.edge.resources.master_aggregations,r=s.total_paid,t=e.edge.resources.service_provider,o=edges.numParse(),n=r.sum,a=t["Funding Target (EUR)"];a=o(a);var i=0;return 0!==n&&(i=0),i=n/a*100,i>100&&(i=100),{pc:i,x:n,y:a}},progressNeeded:function(e){var s=scoss.progressCommitted(e),r=100-s.pc,t=s.y,o=t-s.x;return 0>o&&(o=0),{pc:r,x:o,y:t}},countryDF:function(e){function s(e,s){return s.value-e.value}for(var r=e.edge.resources.master_aggregations,t=r.country,o={key:"Total Funding",values:[]},n=0;n<t.buckets.length;n++){var a=t.buckets[n],i=a.term,d=a.aggs.total_committed.sum;o.values.push({label:i,value:d})}return o.values.sort(s),[o]},continentDF:function(e){function s(e,s){return s.value-e.value}for(var r=e.edge.resources.master_aggregations,t=r.continent,o={key:"Total Funding",values:[]},n=0;n<t.buckets.length;n++){var a=t.buckets[n],i=a.term,d=a.aggs.total_committed.sum;o.values.push({label:i,value:d})}return o.values.sort(s),[o]},topDonorsDFClosure:function(e){var s=e.limit;return function(e){function r(e,s){return s.value-e.value}for(var t=e.edge.resources.master_aggregations,o=t.funders,n={key:"Total Funding",values:[]},a=0;a<o.buckets.length;a++){var i=o.buckets[a],d=i.term,c=i.aggs.total_committed.sum;n.values.push({label:d,value:c})}return n.values.sort(r),n.values=n.values.slice(0,s),[n]}},makeServiceProviderPage:function(e){scoss.activeEdges[e.selector]=edges.newEdge({selector:e.selector,template:scoss.newServiceProviderPageTemplate({top_donor_limit:edges.getParam(e.top_donor_limit,10),funding_progress_header:edges.getParam(e.funding_progress_header,"Funding progress"),funding_progress_intro:edges.getParam(e.funding_progress_intro,""),funding_by_country_header:edges.getParam(e.funding_by_country_header,"Funds committed by country"),funding_by_country_intro:edges.getParam(e.funding_by_country_intro,""),funding_by_continent_header:edges.getParam(e.funding_by_continent_header,"Funds committed by continent"),funding_by_continent_intro:edges.getParam(e.funding_by_continent_intro,""),top_donor_header:edges.getParam(e.top_donor_header,"Top {x} crowdfunders/members"),top_donor_intro:edges.getParam(e.top_donor_intro,"Top crowdfunders/donors by amount committed."),all_donors_header:edges.getParam(e.funding_by_continent_header,"All crowdfunders/members"),all_donors_intro:edges.getParam(e.funding_by_continent_intro,"All crowdfunders/donors ordered alphabetically, showing amount committed")}),staticFiles:[{id:"service_registry",url:e.service_registry,processor:edges.csv.newObjectByRow,datatype:"text",opening:scoss.preprocessServiceProviderSheet({service_id:e.service_id})},{id:"master_data",url:e.master_data,processor:edges.csv.newObjectByRow,datatype:"text",opening:scoss.preprocessMasterSheet({service_id:e.service_id})}],components:[edges.loading.newLoadingBar({id:"progress_committed",calculate:scoss.progressCommitted,renderer:edges.loading_io.newLoadingIORendererBS3({preset:"circle",title:"<h3>Committed</h3>",showXofY:!0,xyNumFormat:scoss.euroFormatter,stroke:scoss.theme.dark_blue,strokeWidth:4,strokeTrailWidth:0,fill:scoss.theme.light_blue})}),edges.loading.newLoadingBar({id:"progress_paid",calculate:scoss.progressPaid,renderer:edges.loading_io.newLoadingIORendererBS3({preset:"circle",title:"<h3>Paid</h3>",showXofY:!0,xyNumFormat:scoss.euroFormatter,stroke:scoss.theme.dark_blue,strokeWidth:5,strokeTrail:scoss.theme.light_blue,strokeTrailWidth:2})}),edges.loading.newLoadingBar({id:"progress_needed",calculate:scoss.progressNeeded,renderer:edges.loading_io.newLoadingIORendererBS3({preset:"circle",title:"<h3>Needed</h3>",showXofY:!0,xyNumFormat:scoss.euroFormatter,stroke:scoss.theme.light_blue,strokeWidth:5,strokeTrail:scoss.theme.dark_blue,strokeTrailWidth:2})}),edges.newHorizontalMultibar({id:"by_country",dataFunction:scoss.countryDF,renderer:edges.nvd3.newHorizontalMultibarRenderer({legend:!1,dynamicHeight:!0,barHeight:40,reserveAbove:50,reserveBelow:50,groupSpacing:.5,yTickFormat:scoss.currencyFormatter,valueFormat:scoss.currencyFormatter,yAxisLabel:"Total Funding (EUR)",color:[scoss.theme.dark_blue],noDataMessage:"No country data currently available"})}),edges.newPieChart({id:"by_continent",dataFunction:scoss.continentDF,renderer:edges.nvd3.newPieChartRenderer({valueFormat:scoss.continentPercentFormatterClosure(e.selector),labelsOutside:!0,color:scoss.theme.pie_colours,noDataMessage:"No continent data currently available"})}),edges.newHorizontalMultibar({id:"top_donors",dataFunction:scoss.topDonorsDFClosure({limit:e.top_donor_limit}),renderer:edges.nvd3.newHorizontalMultibarRenderer({legend:!1,dynamicHeight:!0,barHeight:30,reserveAbove:50,reserveBelow:50,yTickFormat:scoss.currencyFormatter,valueFormat:scoss.currencyFormatter,yAxisLabel:"Total Funding (EUR)",color:[scoss.theme.light_blue],noDataMessage:"No donor/crowdfunder data currently available"})}),scoss.newDonorList({id:"all_donors",renderer:edges.bs3.newTabularResultsRenderer({fieldDisplay:[{field:"donor",display:"Donor/Member"},{field:"committed",display:"Committed",valueFunction:scoss.euroFormatter}],noResultsText:"No donor/crowdfunder data currently available"})})]})},newServiceProviderPageTemplate:function(e){return edges.instantiate(scoss.ServiceProviderPageTemplate,e,edges.newTemplate)},ServiceProviderPageTemplate:function(e){this.params=e,this.namespace="scoss-spp",this.draw=function(e){this.edge=e;var s=edges.css_classes(this.namespace,"container"),r=edges.css_classes(this.namespace,"section"),t=edges.css_classes(this.namespace,"progress_committed"),o=edges.css_classes(this.namespace,"progress_paid"),n=edges.css_classes(this.namespace,"progress_needed"),a=edges.css_classes(this.namespace,"country"),i=edges.css_classes(this.namespace,"continent"),d=edges.css_classes(this.namespace,"top-donors"),c=edges.css_classes(this.namespace,"all-donors"),l=this.params.top_donor_header.replace("{x}",this.params.top_donor_limit),g='<div class="'+s+'">                    <div class="'+r+'">                        <div class="row"><div class="col-md-12"><h2>'+this.params.funding_progress_header+"</h2>"+this.params.funding_progress_intro+'</div></div>                        <div class="row">                            <div class="col-md-2 col-md-offset-2"><div id="progress_committed" class="'+t+'"></div></div>                            <div class="col-md-2 col-md-offset-1"><div id="progress_paid" class="'+o+'"></div></div>                            <div class="col-md-2 col-md-offset-1"><div id="progress_needed" class="'+n+'"></div></div>                        </div>                    </div>                     <div class="'+r+'">                        <div class="row"><div class="col-md-12">                            <h2>'+this.params.funding_by_country_header+"</h2>"+this.params.funding_by_country_intro+'                            <div id="by_country" class="'+a+'"></div>                        </div></div>                    </div>                    <div class="'+r+'">                        <h2>'+this.params.funding_by_continent_header+"</h2>"+this.params.funding_by_continent_intro+'                        <div class="row"><div class="col-md-12"><div id="by_continent" class="'+i+'"></div></div></div>                    </div>                    <div class="'+r+'">                        <h2>'+l+"</h2>"+this.params.top_donor_intro+'                        <div class="row"><div class="col-md-12"><div id="top_donors" class="'+d+'"></div></div></div>                    </div>                    <div class="'+r+'">                        <h2>'+this.params.all_donors_header+"</h2>"+this.params.all_donors_intro+'                        <div class="row"><div class="col-md-10 col-md-offset-1"><div id="all_donors" class="'+c+'"></div></div></div>                    </div>                </div></div>';e.context.html(g)}},newDonorList:function(e){return edges.instantiate(scoss.DonorList,e,edges.newComponent)},DonorList:function(e){this.results=[],this.synchronise=function(){this.results=[];for(var e=this.edge.resources.master_aggregations.funders,s=0;s<e.buckets.length;s++){var r=e.buckets[s];this.results.push({donor:r.term,committed:r.aggs.total_committed.sum})}}}};
